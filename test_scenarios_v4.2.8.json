{
  "test_scenarios": [
    {
      "name": "Тест 1: Проверка исправления промптов",
      "description": "Валидация исправления умножения процентов на 100",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":60},{\"name\":\"white\",\"proportion\":40}],\"angle\":0,\"quality\":\"standard\",\"seed\":42}"
      },
      "expected": {
        "prompt_should_contain": "60% black, 40% white",
        "prompt_should_not_contain": "6000% black, 4000% white",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 2: Проверка ControlNet override",
      "description": "Валидация возможности отключения ControlNet",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":100}],\"angle\":0,\"quality\":\"standard\",\"overrides\":{\"use_controlnet\":false}}"
      },
      "expected": {
        "logs_should_contain": "Using base SDXL pipeline",
        "logs_should_not_contain": "AssertionError",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 3: Проверка смешанных цветов",
      "description": "Валидация работы с различными цветами",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"red\",\"proportion\":70},{\"name\":\"blue\",\"proportion\":30}],\"angle\":45,\"quality\":\"high\",\"seed\":123}"
      },
      "expected": {
        "prompt_should_contain": "70% red, 30% blue",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 4: Проверка трех цветов",
      "description": "Валидация сложных конфигураций",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":60},{\"name\":\"red\",\"proportion\":25},{\"name\":\"white\",\"proportion\":15}],\"angle\":0,\"quality\":\"standard\",\"overrides\":{\"guidance_scale\":8.0,\"num_inference_steps_final\":45}}"
      },
      "expected": {
        "prompt_should_contain": "60% black, 25% red, 15% white",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 5: Проверка предупреждений",
      "description": "Валидация подавления предупреждений",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":100}],\"angle\":0,\"quality\":\"preview\"}"
      },
      "expected": {
        "logs_should_not_contain": "FutureWarning",
        "logs_should_not_contain": "torch.utils._pytree._register_pytree_node",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 6A: ControlNet ON",
      "description": "Сравнительный тест с включенным ControlNet",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":50},{\"name\":\"white\",\"proportion\":50}],\"angle\":0,\"quality\":\"standard\",\"overrides\":{\"use_controlnet\":true}}"
      },
      "expected": {
        "logs_should_contain": "Using ControlNet pipeline",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 6B: ControlNet OFF",
      "description": "Сравнительный тест с отключенным ControlNet",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":50},{\"name\":\"white\",\"proportion\":50}],\"angle\":0,\"quality\":\"standard\",\"overrides\":{\"use_controlnet\":false}}"
      },
      "expected": {
        "logs_should_contain": "Using base SDXL pipeline",
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 7: Проверка производительности",
      "description": "Валидация ускорения генерации",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":100}],\"angle\":0,\"quality\":\"standard\",\"seed\":42}"
      },
      "expected": {
        "total_time_should_be_less_than": 120,
        "status": "succeeded"
      }
    },
    {
      "name": "Тест 8: Проверка цветового маппинга",
      "description": "Валидация улучшенного цветового маппинга",
      "input": {
        "params_json": "{\"colors\":[{\"name\":\"black\",\"proportion\":100}],\"angle\":0,\"quality\":\"standard\"}"
      },
      "expected": {
        "colormap_should_contain": "true black color",
        "status": "succeeded"
      }
    }
  ],
  "validation_criteria": {
    "critical_fixes": [
      "ControlNet override должен работать без ошибок",
      "Промпты должны генерироваться правильно (без умножения на 100)",
      "Предупреждения должны быть полностью подавлены",
      "Цветопередача должна быть корректной"
    ],
    "performance_improvements": [
      "Время генерации должно быть меньше 120 секунд",
      "Параллельная загрузка пайплайнов должна работать",
      "Стабильность должна быть 99.9%"
    ],
    "quality_improvements": [
      "Изображения должны соответствовать запрошенным цветам",
      "Пропорции цветов должны быть правильными",
      "Качество генерации должно быть высоким"
    ]
  }
}
