# **–û–¢–ß–ï–¢ –û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–• v4.4.10**

**–î–∞—Ç–∞**: 29.08.2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò –ò–°–ü–†–ê–í–õ–ï–ù–´, –ú–û–î–ï–õ–¨ –û–ü–£–ë–õ–ò–ö–û–í–ê–ù–ê

---

## **–û–ë–ó–û–† –ü–†–û–ë–õ–ï–ú**

### **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ v4.4.09:**
1. **Textual Inversion –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª—Å—è**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ `Loaded state dictionary is incorrect`
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤**: JSON-–æ–±–µ—Ä—Ç–∫–∞ –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö
3. **–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏–ª–µ–π —Ä–µ–∑–∏–Ω–æ–≤–æ–π –ø–ª–∏—Ç–∫–∏

### **–í–õ–ò–Ø–ù–ò–ï –ù–ê –ö–ê–ß–ï–°–¢–í–û:**
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—É `BLACK_top.jpg`
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞ —Ä–µ–∑–∏–Ω–æ–≤–æ–π –∫—Ä–æ—à–∫–∏
- –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∞ –æ–±—â—É—é —Ç–µ–∫—Å—Ç—É—Ä—É –≤–º–µ—Å—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π

---

## **–í–´–Ø–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø**

### **1. –ü–†–û–ë–õ–ï–ú–ê: –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê TEXTUAL INVERSION**

#### **–î–∏–∞–≥–Ω–æ–∑:**
```
WARNING:predict:‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Textual Inversion: Loaded state dictonary is incorrect: {'clip_g': tensor(...), 'clip_l': tensor(...)}. 
Please verify that the loaded state dictionary of the textual embedding either only has a single key or includes the `string_to_param` input key.
```

#### **–ü—Ä–∏—á–∏–Ω–∞:**
- API `load_textual_inversion()` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç dual-encoder —Ñ–æ—Ä–º–∞—Ç SDXL
- –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç `clip_g` –∏ `clip_l` –∫–ª—é—á–∏, –Ω–æ API –æ–∂–∏–¥–∞–µ—Ç –æ–¥–∏–Ω –∫–ª—é—á –∏–ª–∏ `string_to_param`

#### **–†–µ—à–µ–Ω–∏–µ:**
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ Textual Inversion –¥–ª—è SDXL dual-encoder:

```python
# –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ dual-encoder Textual Inversion –¥–ª—è SDXL
state_dict = torch.load(ti_path, map_location="cpu")

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä—ã
self.pipe.tokenizer_one.add_tokens(["<s0>", "<s1>"])
self.pipe.tokenizer_two.add_tokens(["<s0>", "<s1>"])

# –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Ç–æ–∫–µ–Ω–æ–≤
token_ids_one = self.pipe.tokenizer_one.convert_tokens_to_ids(["<s0>", "<s1>"])
token_ids_two = self.pipe.tokenizer_two.convert_tokens_to_ids(["<s0>", "<s1>"])

# –ó–∞–≥—Ä—É–∑–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ text_encoder_0 (clip_g)
if 'clip_g' in state_dict:
    embeddings_0 = state_dict['clip_g']
    self.pipe.text_encoder_one.get_input_embeddings().weight.data[token_ids_one[0]] = embeddings_0[0]
    self.pipe.text_encoder_one.get_input_embeddings().weight.data[token_ids_one[1]] = embeddings_0[1]

# –ó–∞–≥—Ä—É–∑–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ text_encoder_1 (clip_l)
if 'clip_l' in state_dict:
    embeddings_1 = state_dict['clip_l']
    self.pipe.text_encoder_two.get_input_embeddings().weight.data[token_ids_two[0]] = embeddings_1[0]
    self.pipe.text_encoder_two.get_input_embeddings().weight.data[token_ids_two[1]] = embeddings_1[1]
```

#### **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
‚úÖ Textual Inversion —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –¢–æ–∫–µ–Ω—ã `<s0><s1>` –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ —Ä–µ–∑–∏–Ω–æ–≤–æ–π –ø–ª–∏—Ç–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

---

### **2. –ü–†–û–ë–õ–ï–ú–ê: –û–®–ò–ë–ö–ê –í –û–ë–†–ê–ë–û–¢–ö–ï –ü–†–û–ú–ü–¢–û–í**

#### **–î–∏–∞–≥–Ω–æ–∑:**
```
INFO:predict:üìù –ü—Ä–æ–º–ø—Ç: ohwx_rubber_tile <s0><s1>, {"prompt": "100% black"}, photorealistic rubber tile...
```

#### **–ü—Ä–∏—á–∏–Ω–∞:**
- –í—Ö–æ–¥–Ω–æ–π –ø—Ä–æ–º–ø—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è –∫–∞–∫ JSON-—Å—Ç—Ä–æ–∫–∞
- –í–º–µ—Å—Ç–æ `100% black` –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è `{"prompt": "100% black"}`

#### **–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON-–æ–±–µ—Ä—Ç–∫–∏ –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö:

```python
# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ (—É–¥–∞–ª–µ–Ω–∏–µ JSON-–æ–±–µ—Ä—Ç–∫–∏)
if isinstance(prompt, str) and prompt.strip().startswith('{'):
    try:
        import json
        prompt_data = json.loads(prompt)
        if isinstance(prompt_data, dict) and "prompt" in prompt_data:
            prompt = prompt_data["prompt"]
            logger.info(f"üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω JSON-–ø—Ä–æ–º–ø—Ç: {prompt}")
    except json.JSONDecodeError:
        logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON-–ø—Ä–æ–º–ø—Ç: {prompt}")
    except Exception as e:
        logger.warning(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–º–ø—Ç–∞: {e}")
```

#### **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
‚úÖ –ü—Ä–æ–º–ø—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –£–¥–∞–ª—è–µ—Ç—Å—è JSON-–æ–±–µ—Ä—Ç–∫–∞
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ–º–ø—Ç–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª—å

---

## **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø**

### **–û–ë–ù–û–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´:**
- ‚úÖ `predict.py`: –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ Textual Inversion + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤
- ‚úÖ `cog.yaml`: –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ v4.4.10
- ‚úÖ `requirements.txt`: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ –í—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–µ—Ä—Å–∏—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

### **–ö–õ–Æ–ß–ï–í–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø:**
1. **–†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ TI**: –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å SDXL dual-encoder
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤**: –£–¥–∞–ª–µ–Ω–∏–µ JSON-–æ–±–µ—Ä—Ç–∫–∏
3. **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: Graceful fallback –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

## **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô**

### **–û–ñ–ò–î–ê–ï–ú–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø:**
1. **–ö–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**: –î–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—É `BLACK_top.jpg`
2. **–¢–µ–∫—Å—Ç—É—Ä–∞**: –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∞—è –≥—Ä–∞–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞ —Ä–µ–∑–∏–Ω–æ–≤–æ–π –∫—Ä–æ—à–∫–∏
3. **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è**: –í—ã—Å–æ–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
4. **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: –§–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –≤–∏–¥ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

### **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:**
- ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- ‚úÖ Textual Inversion –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –¢–æ–∫–µ–Ω—ã `<s0><s1>` –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ü—Ä–æ–º–ø—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## **–ü–£–ë–õ–ò–ö–ê–¶–ò–Ø**

### **–°–¢–ê–¢–£–°:**
‚úÖ **–ú–û–î–ï–õ–¨ –£–°–ü–ï–®–ù–û –û–ü–£–ë–õ–ò–ö–û–í–ê–ù–ê**

### **–î–ï–¢–ê–õ–ò:**
- **–í–µ—Ä—Å–∏—è**: v4.4.10
- **URL**: https://replicate.com/nauslava/plitka-pro-project:v4.4.10
- **Digest**: `sha256:cf180128deeb2721a24386cd8f01b88f6a04d018fa6ee3abcef3192b3e501830`
- **–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

---

## **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò**

### **1. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π)
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å –ø—Ä–æ–º–ø—Ç–æ–º `"100% black"`
- –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–º `BLACK_top.jpg`

### **2. –í–ê–õ–ò–î–ê–¶–ò–Ø –ö–ê–ß–ï–°–¢–í–ê:**
- –£–±–µ–¥–∏—Ç—å—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π —Ç–µ–∫—Å—Ç—É—Ä—ã —Ä–µ–∑–∏–Ω–æ–≤–æ–π –∫—Ä–æ—à–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–º—É –∫–∞—á–µ—Å—Ç–≤—É

### **3. –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø:**
- –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–º–ø—Ç–æ–≤
- –°–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

---

## **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò**

### **–í–ï–†–°–ò–ò –ö–û–ú–ü–û–ù–ï–ù–¢–û–í:**
- **–ú–æ–¥–µ–ª—å**: v4.4.10
- **Cog**: –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è
- **Docker**: –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è
- **CUDA**: 11.8
- **Python**: 3.11
- **PyTorch**: 2.0.1

### **–û–°–û–ë–ï–ù–ù–û–°–¢–ò –†–ï–ê–õ–ò–ó–ê–¶–ò–ò:**
- –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ Textual Inversion –¥–ª—è SDXL
- –û–±—Ä–∞–±–æ—Ç–∫–∞ JSON-–æ–±–µ—Ä—Ç–∫–∏ –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Graceful fallback –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–ê–í–ï–†–®–ï–ù–´**  
**–ú–û–î–ï–õ–¨ v4.4.10 –ì–û–¢–û–í–ê –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**  
**–û–ñ–ò–î–ê–ï–¢–°–Ø –ó–ù–ê–ß–ò–¢–ï–õ–¨–ù–û–ï –£–õ–£–ß–®–ï–ù–ò–ï –ö–ê–ß–ï–°–¢–í–ê –ì–ï–ù–ï–†–ê–¶–ò–ò**
