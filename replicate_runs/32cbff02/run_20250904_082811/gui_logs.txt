[2025-09-04 08:28:11] Prediction id: xx7s0mjvq5rgc0cs2cs9319j20
[2025-09-04 08:28:11] 🔍 Начинаем создание папки для результатов...
[2025-09-04 08:28:11] 🔍 Текущий рабочий каталог: /home/papaandrey/plitka-pro-project
[2025-09-04 08:28:11] 🔍 Автоматически определенные значения:
[2025-09-04 08:28:11] 🔍 ver_for_hash: v4.5.01
[2025-09-04 08:28:11] 🔐 forced_hash: 32cbff02
[2025-09-04 08:28:11] 🔄 Папка создана: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:28:11] 🔄 _current_run_dir установлен: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:28:11] 🔐 Создаем папку с хешем: 32cbff02
[2025-09-04 08:28:11] 📁 Создана папка: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:28:11] 🔐 Хеш версии: 32cbff02
[2025-09-04 08:28:11] 🔍 Базовая папка: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02
[2025-09-04 08:28:11] 🔍 Полный путь: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:28:11] ✅ Папка успешно создана и существует
[2025-09-04 08:28:12] INFO:coglet:prediction started: id=xx7s0mjvq5rgc0cs2cs9319j20
WARNING unknown input field ignored: colormap
[2025-09-04 08:28:12] 
✅ Startup phase completed. Proceeding to completion...
[2025-09-04 08:28:19] WARNING unknown input field ignored: granule_size
WARNING unknown input field ignored: guidance_scale
WARNING unknown input field ignored: num_inference_steps
WARNING unknown input field ignored: test_purpose
INFO:predict:🚀 STARTUP_SNAPSHOT_START
INFO:predict:🧭 MODEL_START v4.5.01 | device=cuda | diffusers=0.21.4 | torch=2.1.0+cu121
INFO:predict:📊 GPU: Tesla T4
INFO:predict:💾 GPU Memory: 14.6 GB
INFO:predict:🔧 SDXL Base: unknown
INFO:predict:🎨 LoRA: unknown (rank: 32)
INFO:predict:🔤 TI: unknown (tokens: <s0><s1>)
INFO:predict:⚙️ Scheduler: DPMSolverMultistepScheduler
INFO:predict:🎭 VAE: AutoencoderKL
INFO:predict:🎯 Prompt: ohwx_rubber_tile <s0><s1> 30% red, 30% blue, 20% dkgreen, 20% yellow rubber tile, granular pattern, realistic granules
INFO:predict:🚫 Negative Prompt: missing red, missing blue, missing dkgreen, missing yellow, blurry, low quality, solid areas
INFO:predict:🎲 Seed: 789
INFO:predict:📊 Steps: 20 (базовый)
INFO:predict:🎚️ Guidance: 7.0 (базовый)
INFO:predict:🔧 LoRA Scale: 0.7 (базовый)
INFO:predict:🎨 Адаптивные параметры будут рассчитаны на основе количества цветов
INFO:predict:🚀 STARTUP_SNAPSHOT_END
INFO:predict:🎨 Начало генерации изображения...
INFO:predict:📝 Входной промпт: ohwx_rubber_tile <s0><s1> 30% red, 30% blue, 20% dkgreen, 20% yellow rubber tile, granular pattern, realistic granules
INFO:predict:🚫 Входной негативный промпт: missing red, missing blue, missing dkgreen, missing yellow, blurry, low quality, solid areas
INFO:predict:🎲 Входной сид: 789
INFO:predict:🎨 Генерация изображения...
INFO:predict:📝 Полный промпт: ohwx_rubber_tile <s0><s1> 30% red, 30% blue, 20% dkgreen, 20% yellow rubber tile, granular pattern, realistic granules, photorealistic rubber tile, high quality, detailed texture, professional photography, sharp focus
INFO:predict:🚫 Финальный негативный промпт: missing red, missing blue, missing dkgreen, missing yellow, blurry, low quality, solid areas
INFO:predict:🎲 Финальный сид: 789
INFO:predict:🔧 Устройство: cuda
INFO:predict:🎨 Анализ сложности промпта для адаптивных параметров...
INFO:predict:🎨 Обнаружено цветов в промпте: 4
INFO:predict:🎯 Адаптивные параметры для 4+ цветов: steps=35, guidance=8.5
INFO:predict:🚀 Запуск pipeline для генерации с адаптивными параметрами...
INFO:predict:🎯 Автоматически включаем мультимодальный ControlNet для 4 цветов: ['t2i_color', 'color_grid', 'shuffle']
INFO:predict:🔗 Загрузка ControlNet SoftEdge для SDXL...
WARNING:predict:⚠️ ControlNet недоступен: diffusers/controlnet-softedge-sdxl-1.0 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login`.
INFO:predict:🚀 Финальный сегмент: единый проход без callback

  0%|          | 0/35 [00:00<?, ?it/s]
  3%|▎         | 1/35 [00:01<00:36,  1.07s/it]
  6%|▌         | 2/35 [00:02<00:34,  1.05s/it]
  9%|▊         | 3/35 [00:03<00:33,  1.04s/it]
 11%|█▏        | 4/35 [00:04<00:32,  1.04s/it]
 14%|█▍        | 5/35 [00:05<00:31,  1.04s/it]
[2025-09-04 08:28:25]  17%|█▋        | 6/35 [00:06<00:30,  1.04s/it]
 20%|██        | 7/35 [00:07<00:29,  1.04s/it]
 23%|██▎       | 8/35 [00:08<00:28,  1.05s/it]
 26%|██▌       | 9/35 [00:09<00:27,  1.05s/it]
 29%|██▊       | 10/35 [00:10<00:26,  1.05s/it]
 31%|███▏      | 11/35 [00:11<00:25,  1.06s/it]
 34%|███▍      | 12/35 [00:12<00:24,  1.06s/it]
[2025-09-04 08:28:32]  37%|███▋      | 13/35 [00:13<00:23,  1.06s/it]
 40%|████      | 14/35 [00:14<00:22,  1.07s/it]
 43%|████▎     | 15/35 [00:15<00:21,  1.07s/it]
 46%|████▌     | 16/35 [00:16<00:20,  1.07s/it]
 49%|████▊     | 17/35 [00:18<00:19,  1.08s/it]
 51%|█████▏    | 18/35 [00:19<00:18,  1.08s/it]
[2025-09-04 08:28:38]  54%|█████▍    | 19/35 [00:20<00:17,  1.09s/it]
 57%|█████▋    | 20/35 [00:21<00:16,  1.09s/it]
 60%|██████    | 21/35 [00:22<00:15,  1.10s/it]
 63%|██████▎   | 22/35 [00:23<00:14,  1.10s/it]
 66%|██████▌   | 23/35 [00:24<00:13,  1.10s/it]
 69%|██████▊   | 24/35 [00:25<00:12,  1.11s/it]
[2025-09-04 08:28:45]  71%|███████▏  | 25/35 [00:26<00:11,  1.11s/it]
 74%|███████▍  | 26/35 [00:27<00:09,  1.10s/it]
 77%|███████▋  | 27/35 [00:29<00:08,  1.10s/it]
 80%|████████  | 28/35 [00:30<00:07,  1.10s/it]
 83%|████████▎ | 29/35 [00:31<00:06,  1.10s/it]
[2025-09-04 08:28:52]  86%|████████▌ | 30/35 [00:32<00:05,  1.09s/it]
 89%|████████▊ | 31/35 [00:33<00:04,  1.09s/it]
 91%|█████████▏| 32/35 [00:34<00:03,  1.09s/it]
 94%|█████████▍| 33/35 [00:35<00:02,  1.08s/it]
 97%|█████████▋| 34/35 [00:36<00:01,  1.08s/it]
[2025-09-04 08:28:58] 100%|██████████| 35/35 [00:37<00:00,  1.07s/it]
100%|██████████| 35/35 [00:37<00:00,  1.08s/it]
INFO:predict:✅ Финальная генерация завершена
INFO:predict:📊 Размер сгенерированного изображения: (1024, 1024)
INFO:predict:✅ FINAL_READY /tmp/final.png
WARNING:predict:⚠️ Недопустимый цвет в промпте: yellow rubber tile
INFO:predict:🎨 Создание colormap: 3 цветов, паттерн: granular, гранулы: small
INFO:predict:✅ Оптимизированный colormap создан: (1024, 1024)
INFO:predict:📊 Статистика паттернов: {'random': 1, 'grid': 0, 'radial': 0, 'granular': 2}
INFO:predict:📊 Статистика размеров гранул: {'small': 1, 'medium': 2, 'large': 0}
ERROR:predict:❌ Ошибка валидации colormap: operands could not be broadcast together with shapes (1024,1024,4) (3,) 
WARNING:predict:⚠️ Colormap не соответствует промпту, пересоздаем...
INFO:predict:🔧 Принудительная пересборка colormap...
INFO:predict:✅ Colormap пересобран для цветов: ['red', 'blue', 'dkgreen', 'yellow']
INFO:predict:🎨 ОПТИМИЗИРОВАННЫЙ COLORMAP_READY /tmp/colormap.png
INFO:predict:📊 Размер colormap: (1024, 1024)
INFO:predict:📋 ЛЕГЕНДА_READY /tmp/legend.png
INFO:predict:🧹 Память очищена
INFO:predict:📄 JSON_READY /tmp/generation_data.json
INFO:predict:✅ Изображение успешно сгенерировано!
INFO:predict:📊 Color Grid Adapter статистика:
INFO:predict:   - Всего генераций: 4
INFO:predict:   - ControlNet использован: 3 (75.0%)
INFO:predict:   - Популярный паттерн: granular
INFO:predict:   - Популярный размер гранул: medium
INFO:coglet:prediction completed: id=xx7s0mjvq5rgc0cs2cs9319j20
[2025-09-04 08:28:58] 🔄 Загрузка изображения 0: https://replicate.delivery/czjl/vPQlfap1AzVZYqSwlQ7bMf056Ry5AYRerpaqTP526k1usajqA/final.png
[2025-09-04 08:29:00] ✅ Изображение сохранено: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811/out_0.png
[2025-09-04 08:29:00] 🔄 Загрузка изображения 1: https://replicate.delivery/czjl/fTJE6GiwCY1eD0BYRDtvf2gyFbtTlcEzKfFcCC5DGLwfyqNqC/colormap.png
[2025-09-04 08:29:00] ✅ Изображение сохранено: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811/out_1.png
[2025-09-04 08:29:00] 🔄 Загрузка изображения 2: https://replicate.delivery/czjl/uTmdwJgVoNYzPRLxKLyLOWnoNgPYcfuJrrXdvfaeoBbvsajqA/legend.png
[2025-09-04 08:29:01] ✅ Изображение сохранено: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811/out_2.png
[2025-09-04 08:29:01] 
=== Final status: succeeded
[2025-09-04 08:29:01] [
  "https://replicate.delivery/czjl/vPQlfap1AzVZYqSwlQ7bMf056Ry5AYRerpaqTP526k1usajqA/final.png",
  "https://replicate.delivery/czjl/fTJE6GiwCY1eD0BYRDtvf2gyFbtTlcEzKfFcCC5DGLwfyqNqC/colormap.png",
  "https://replicate.delivery/czjl/uTmdwJgVoNYzPRLxKLyLOWnoNgPYcfuJrrXdvfaeoBbvsajqA/legend.png"
]
[2025-09-04 08:29:01] 🔄 _save_outputs вызван
[2025-09-04 08:29:01] 💾 Сохраняем результаты в папку: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:29:01] 🔐 ПРИНУДИТЕЛЬНО используем хеш: 89fdd926
[2025-09-04 08:29:01] ✅ Используем подготовленную папку: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:29:01] 🔄 Начинаем обработку 3 выходных файлов...
[2025-09-04 08:29:01] 📁 Папка для сохранения: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811
[2025-09-04 08:29:02] 📥 Скачан файл 0: out_0.png
[2025-09-04 08:29:02] 📥 Скачан файл 1: out_1.png
[2025-09-04 08:29:02] 📥 Скачан файл 2: out_2.png
[2025-09-04 08:29:02] 📁 Найдено файлов для переименования: 3
[2025-09-04 08:29:02] 📝 Промпт для именования: 'ohwx_rubber_tile_<s0><s1>_30pct_red,_30pct_blue,_2'
[2025-09-04 08:29:02] ⏰ Временная метка из папки: 20250904_082811
[2025-09-04 08:29:03] 🔐 Автоматически определенный хеш версии: 315aaaea
[2025-09-04 08:29:03] ✅ FINAL saved as: 20250904_082811_ohwx_rubber_tile_<s0><s1>_30pct_red,_30pct_blue,_2_final_315aaaea.png
[2025-09-04 08:29:03] 📁 Путь: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811/20250904_082811_ohwx_rubber_tile_<s0><s1>_30pct_red,_30pct_blue,_2_final_315aaaea.png
[2025-09-04 08:29:03] 🎨 COLORMAP saved as: 20250904_082811_ohwx_rubber_tile_<s0><s1>_30pct_red,_30pct_blue,_2_colormap_315aaaea.png
[2025-09-04 08:29:03] 📁 Путь: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02/run_20250904_082811/20250904_082811_ohwx_rubber_tile_<s0><s1>_30pct_red,_30pct_blue,_2_colormap_315aaaea.png
[2025-09-04 08:29:03] 
[GUI] Done.
[2025-09-04 08:29:07] 📋 Выбран пресет: 🎨 RGBA COLORMAP VALIDATION ✅
[2025-09-04 08:29:10] 📋 Выбрано пресетов: 2
[2025-09-04 08:29:10]   • 🎨 RGBA COLORMAP VALIDATION
[2025-09-04 08:29:10]   • 🔧 CONTROLNET T2I_COLOR TEST
[2025-09-04 08:29:12] 📋 Выбрано пресетов: 3
[2025-09-04 08:29:12]   • 🎨 RGBA COLORMAP VALIDATION
[2025-09-04 08:29:12]   • 🔧 CONTROLNET T2I_COLOR TEST
[2025-09-04 08:29:12]   • 🔧 CONTROLNET COLOR_GRID TEST
[2025-09-04 08:29:17] 📋 Выбрано пресетов: 4
[2025-09-04 08:29:17]   • 🎨 RGBA COLORMAP VALIDATION
[2025-09-04 08:29:17]   • 🔧 CONTROLNET T2I_COLOR TEST
[2025-09-04 08:29:17]   • 🔧 CONTROLNET COLOR_GRID TEST
[2025-09-04 08:29:17]   • 🔧 CONTROLNET SHUFFLE TEST
[2025-09-04 08:29:18] 🔄 on_start() вызван
[2025-09-04 08:29:18] 
[GUI] Starting tests...
[2025-09-04 08:29:18] 🚀 Запуск с версией: v4.5.01
[2025-09-04 08:29:18] 🔐 Хеш папки: 32cbff02
[2025-09-04 08:29:18] 📁 Ожидаемая папка: replicate_runs/32cbff02/
[2025-09-04 08:29:18] 🔍 Текущий рабочий каталог: /home/papaandrey/plitka-pro-project
[2025-09-04 08:29:18] 📁 Полный путь: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02
[2025-09-04 08:29:18] 📁 Абсолютный путь: /home/papaandrey/plitka-pro-project/replicate_runs/32cbff02
[2025-09-04 08:29:18] --------------------------------------------------
[2025-09-04 08:29:18] 🔄 run_presets() вызван
[2025-09-04 08:29:18] 
################ PRESET: 🎨 RGBA COLORMAP VALIDATION ################
[2025-09-04 08:29:18] 🔄 _run_single() вызван
[2025-09-04 08:29:18] 
=== Creating prediction: nauslava/plitka-pro-project (version: 32cbff024118a62304c89c1d5246664b37652e308d024d82e35d10b316d881a5)
Inputs: {"prompt": "ohwx_rubber_tile <s0><s1> 60% red, 40% blue rubber tile, random pattern, organic texture, high quality", "negative_prompt": "missing red, missing blue, blurry, low quality, artifacts", "num_inference_steps": 25, "guidance_scale": 7.5, "seed": 101, "colormap": "random", "granule_size": "medium", "test_purpose": "Тестирование валидации RGBA colormap"}
[2025-09-04 08:29:18] 🔄 Worker.start() вызван, поток запущен
[2025-09-04 08:29:19] Prediction id: 4v2s1eb2wsrg80cs2csr0j965c
[2025-09-04 08:29:19] 🔍 Начинаем создание папки для результатов...
[2025-09-04 08:29:19] 🔍 Текущий рабочий каталог: /home/papaandrey/plitka-pro-project
