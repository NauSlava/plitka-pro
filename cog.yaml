# cog.yaml
# Version: v4.4.56 - RUBBER TILE GENERATION MODEL (Color Grid Adapter + ControlNet Integration)
# Description: Модель для генерации изображений резиновой плитки с использованием НАШЕЙ обученной модели
# Changes:
# - НОВАЯ ФУНКЦИЯ: Color Grid Adapter для точного контроля цветовых пропорций
# - НОВАЯ ФУНКЦИЯ: Автоматическое включение ControlNet для 2+ цветов
# - НОВАЯ ФУНКЦИЯ: Адаптивные параметры генерации на основе количества цветов
# - НОВАЯ ФУНКЦИЯ: Оптимизированные colormap паттерны (random, grid, radial, granular)
# - НОВАЯ ФУНКЦИЯ: Настраиваемые размеры гранул (small, medium, large)
# - ИСПРАВЛЕНИЕ: Выравнивание с успешной конфигурацией модели v45
# - ИСПРАВЛЕНИЕ: LoRA загрузка через set_adapters() + fuse_lora() для максимальной эффективности
# - ИСПРАВЛЕНИЕ: Оптимальные параметры по умолчанию (steps: 20, guidance: 7.0, lora_scale: 0.7)
# - ИСПРАВЛЕНИЕ: Включен VAE tiling для лучшей детализации
# - ИСПРАВЛЕНИЕ: Адаптивные steps и guidance для различного количества цветов
# - ТЕСТИРОВАНИЕ: Полная адаптация тестовой системы для Color Grid Adapter
# - ТЕСТИРОВАНИЕ: Специальные пресеты для всех паттернов и размеров гранул
# - ТЕСТИРОВАНИЕ: Комплексное тестирование одним командой
# - МОНИТОРИНГ: Статистика использования Color Grid Adapter и ControlNet
# - МОНИТОРИНГ: Автоматический анализ промптов и ожидаемых результатов
# - ДОКУМЕНТАЦИЯ: Полная синхронизация с новыми возможностями

build:
  gpu: true
  cuda: "12.1"
  python_version: "3.11"
  python_requirements: "requirements.txt"
  system_packages:
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
  cog_runtime: true

predict: "predict.py:Predictor"

image: "r8.im/nauslava/plitka-pro-project:v4.4.56"